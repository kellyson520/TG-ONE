# Telegram转发器 Web管理系统

一个功能强大的Web后台管理界面，为Telegram转发器提供图形化操作和可视化配置功能。

## 🌟 主要特性

### 📊 实时数据监控
- **系统概览**: 实时显示转发规则数量、活跃状态、今日转发量等关键指标
- **性能监控**: CPU、内存使用率，系统健康状态一目了然
- **活动日志**: 实时展示系统操作记录和错误信息

### ⚙️ 图形化规则管理
- **可视化配置**: 通过直观的界面创建和编辑转发规则
- **批量操作**: 支持批量启用/禁用、删除规则
- **规则筛选**: 按状态、来源、目标等多维度筛选规则
- **快速编辑**: 内联编辑功能，快速修改规则参数

### 🗺️ 拖拽式可视化图
- **方块连线**: 通过拖拽方块创建转发关系，直观配置转发流程
- **自动布局**: 智能排列节点，优化显示效果
- **实时预览**: 即时预览转发关系，支持保存和加载布局
- **交互操作**: 支持缩放、移动、选择等丰富的交互功能

### 🔗 聊天管理
- **链接输入**: 简单输入Telegram聊天链接即可添加到系统
- **批量导入**: 支持从文件批量导入聊天列表
- **智能识别**: 自动识别聊天类型、成员数等信息

## 🚀 快速开始

## 🚀 快速开始

### 1. 技术栈说明
- **前端**: React + Vite + TypeScript + Tailwind CSS (位于 `web_admin/frontend`)
- **后端**: FastAPI (位于 `web_admin` 根目录)

### 2. 开发环境设置

#### 后端
系统集成在主进程中，随 `python main.py` 自动启动 FastAPI 服务。
默认端口: `9000`

#### 前端 (开发模式)
```bash
cd web_admin/frontend
npm install
npm run dev
```
访问: `http://localhost:5173`

### 3. 构建与部署

前端构建产物由 FastAPI 自动托管。若修改了前端代码，需要重新构建：

```bash
cd web_admin/frontend
npm run build
```
构建完成后，产物会自动输出到 `web_admin/frontend/dist`，重启 Python 主程序即可生效。

### 4. 访问管理界面 (生产环境)

- **主页**: http://localhost:9000
- **Docker 映射**: 默认映射到宿主机 9810 端口 -> `http://localhost:9810`

## 📖 使用指南

### 可视化转发关系配置

1. **访问可视化页面**: 点击导航栏的"可视化图"
2. **添加聊天节点**: 
   - 点击"添加聊天"按钮
   - 输入Telegram聊天链接，如：`@channel_name` 或 `https://t.me/channel_name`
3. **创建规则节点**: 点击"添加规则"按钮
4. **连接节点**: 
   - 点击"连接模式"按钮激活连线功能
   - 先点击来源聊天，再点击规则节点，最后点击目标聊天
5. **保存配置**: 点击"保存布局"导出配置文件

### 规则管理

1. **创建新规则**:
   - 点击"新建规则"按钮
   - 填写来源和目标聊天信息
   - 配置筛选条件（关键词、媒体类型等）
   - 设置高级选项（延迟、文件大小限制等）

2. **管理现有规则**:
   - 使用筛选器快速找到目标规则
   - 点击规则卡片上的操作按钮进行编辑、启用/禁用、删除
   - 支持批量操作和导入/导出

### 系统监控

1. **查看实时数据**: 仪表板页面显示所有关键指标
2. **性能监控**: 观察CPU、内存使用情况
3. **日志查看**: 查看最近的活动记录和错误信息

## 🛠️ API接口

后端提供完整的 RESTful API，基于 FastAPI 构建，支持 Swagger UI 文档 (访问 `/docs`)。

### 核心模块
- **认证**: `POST /api/auth/token`, `POST /api/auth/login`
- **系统**: `GET /api/system/stats`, `GET /api/system/logs`
- **规则**: `GET /api/rules`, `POST /api/rules`
- **WS**: `WS /ws/logs` (实时日志推送)

详细文档请参考在线 Swagger UI。

## 🎨 界面预览

### 主页
- 系统概览和快速操作入口
- 关键指标展示
- 功能特性介绍

### 仪表板
- 实时数据图表
- 系统状态监控
- 性能指标展示
- 活动日志记录

### 规则管理
- 规则列表视图
- 创建/编辑规则表单
- 批量操作工具
- 高级筛选功能

### 可视化图
- 拖拽式节点操作
- 连线关系展示
- 自动布局功能
- 缩放和导航控制

## 🔧 高级配置

### 环境变量 (.env)

```bash
# Web Admin Port
WEB_PORT=9000

# Security (JWT)
SECRET_KEY=your_secret_key_here
ACCESS_TOKEN_EXPIRE_MINUTES=43200

# 数据库配置
DATABASE_URL=sqlite:///./db/forward.db

# API配置
API_RATE_LIMIT=100
```

### 自定义主题

Web界面支持深色和浅色主题，会自动根据系统偏好切换，也可手动切换。

### 移动端适配

界面完全响应式设计，支持手机和平板设备访问。

## ⚠️ 注意事项

1. **安全性**: 
   - 默认监听所有IP地址，生产环境请配置防火墙
   - 建议配置HTTPS和用户认证

2. **性能**: 
   - 大量规则时建议分页加载
   - 可视化图节点数量建议控制在100个以内

3. **兼容性**:
   - 支持现代浏览器（Chrome 80+, Firefox 75+, Safari 13+）
   - 不支持IE浏览器

## 🤝 贡献

欢迎提交Issue和Pull Request来改进Web管理系统！

## 📄 许可证

本项目采用MIT许可证，详见LICENSE文件。
