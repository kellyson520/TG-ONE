<!-- å‘½ä»¤è¡Œé¢æ¿ç»„ä»¶ -->
<div class="command-panel-wrapper" id="commandPanel">
    <div class="command-panel-header">
        <div class="d-flex align-items-center justify-content-between">
            <div class="d-flex align-items-center gap-2">
                <i class="bi bi-terminal-fill text-success"></i>
                <h6 class="mb-0 fw-bold">å‘½ä»¤è¡Œé¢æ¿</h6>
                <span class="badge bg-success-soft">Bot Commands</span>
            </div>
            <div class="d-flex gap-2">
                <button class="btn btn-sm btn-outline-secondary" onclick="toggleCommandList()" title="å‘½ä»¤åˆ—è¡¨">
                    <i class="bi bi-list-ul"></i>
                </button>
                <button class="btn btn-sm btn-outline-secondary" onclick="clearCommandHistory()" title="æ¸…ç©ºå†å²">
                    <i class="bi bi-trash"></i>
                </button>
                <button class="btn btn-sm btn-outline-secondary" onclick="toggleCommandPanel()" title="æœ€å°åŒ–">
                    <i class="bi bi-chevron-down"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- å‘½ä»¤è¾“å‡ºåŒºåŸŸ (ç»ˆç«¯æ ·å¼) -->
    <div class="command-output" id="commandOutput">
        <div class="welcome-message">
            <div class="text-success mb-2">
                â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—<br>
                â•‘  ğŸ¤– Telegram Forwarder Bot - Web Terminal v1.0           â•‘<br>
                â•‘  è¾“å…¥å‘½ä»¤æˆ–ç‚¹å‡»ä¸‹æ–¹å¿«æ·æŒ‰é’®å¼€å§‹                            â•‘<br>
                â•‘  æç¤º: è¾“å…¥ /help æŸ¥çœ‹æ‰€æœ‰å¯ç”¨å‘½ä»¤                        â•‘<br>
                â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            </div>
        </div>
    </div>

    <!-- å‘½ä»¤è¾“å…¥åŒºåŸŸ -->
    <div class="command-input-wrapper">
        <div class="input-group">
            <span class="input-group-text bg-transparent border-0">
                <i class="bi bi-chevron-right text-success"></i>
            </span>
            <input 
                type="text" 
                class="form-control command-input" 
                id="commandInput" 
                placeholder="è¾“å…¥å‘½ä»¤... (ä¾‹å¦‚: /help, /bind, /add)"
                autocomplete="off"
                spellcheck="false"
            >
            <button class="btn btn-success" onclick="executeCommand()">
                <i class="bi bi-send-fill me-1"></i>æ‰§è¡Œ
            </button>
        </div>
        
        <!-- è‡ªåŠ¨è¡¥å…¨å»ºè®® -->
        <div class="autocomplete-suggestions" id="autocompleteSuggestions"></div>
    </div>

    <!-- å¿«æ·å‘½ä»¤æŒ‰é’® -->
    <div class="quick-commands">
        <div class="d-flex flex-wrap gap-2 mb-2">
            <small class="text-muted w-100 mb-1">âš¡ å¿«æ·å‘½ä»¤:</small>
            <button class="btn btn-sm btn-outline-primary" onclick="insertCommand('/help')">
                <i class="bi bi-question-circle"></i> å¸®åŠ©
            </button>
            <button class="btn btn-sm btn-outline-primary" onclick="insertCommand('/bind ')">
                <i class="bi bi-link-45deg"></i> ç»‘å®šè§„åˆ™
            </button>
            <button class="btn btn-sm btn-outline-primary" onclick="insertCommand('/add ')">
                <i class="bi bi-plus-circle"></i> æ·»åŠ å…³é”®å­—
            </button>
            <button class="btn btn-sm btn-outline-primary" onclick="insertCommand('/list_keyword')">
                <i class="bi bi-list-ul"></i> æŸ¥çœ‹å…³é”®å­—
            </button>
            <button class="btn btn-sm btn-outline-primary" onclick="insertCommand('/settings')">
                <i class="bi bi-gear"></i> è®¾ç½®
            </button>
            <button class="btn btn-sm btn-outline-primary" onclick="insertCommand('/switch')">
                <i class="bi bi-arrow-left-right"></i> åˆ‡æ¢è§„åˆ™
            </button>
        </div>
    </div>

    <!-- å‘½ä»¤å†å²è®°å½• (éšè—é»˜è®¤) -->
    <div class="command-history collapse" id="commandHistory">
        <div class="d-flex align-items-center justify-content-between mb-2">
            <small class="text-muted">ğŸ“œ å‘½ä»¤å†å² (æœ€è¿‘10æ¡)</small>
            <small class="text-muted">æç¤º: â†‘/â†“ æµè§ˆå†å²</small>
        </div>
        <div class="history-list" id="historyList">
            <!-- åŠ¨æ€å¡«å…… -->
        </div>
    </div>
</div>

<!-- å‘½ä»¤åˆ—è¡¨ä¾§è¾¹æ  (é»˜è®¤éšè—) -->
<div class="command-list-sidebar offcanvas offcanvas-end" tabindex="-1" id="commandListSidebar">
    <div class="offcanvas-header">
        <h5 class="offcanvas-title">
            <i class="bi bi-book text-primary"></i> å¯ç”¨å‘½ä»¤åˆ—è¡¨
        </h5>
        <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
    </div>
    <div class="offcanvas-body">
        <!-- æœç´¢å‘½ä»¤ -->
        <div class="mb-3">
            <input 
                type="text" 
                class="form-control" 
                id="commandSearchInput" 
                placeholder="æœç´¢å‘½ä»¤..."
                oninput="filterCommands(this.value)"
            >
        </div>

        <!-- å‘½ä»¤åˆ†ç±» -->
        <div class="command-categories" id="commandCategories">
            <!-- åŸºç¡€å‘½ä»¤ -->
            <div class="command-category mb-4">
                <h6 class="category-title">
                    <i class="bi bi-info-circle text-info"></i> åŸºç¡€å‘½ä»¤
                </h6>
                <div class="command-list">
                    <div class="command-item" onclick="insertCommand('/start')">
                        <code>/start</code>
                        <small class="text-muted">å¼€å§‹ä½¿ç”¨</small>
                    </div>
                    <div class="command-item" onclick="insertCommand('/help')">
                        <code>/help</code> <span class="badge bg-secondary">ç®€å†™: /h</span>
                        <small class="text-muted">æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯</small>
                    </div>
                    <div class="command-item" onclick="insertCommand('/changelog')">
                        <code>/changelog</code> <span class="badge bg-secondary">ç®€å†™: /cl</span>
                        <small class="text-muted">æŸ¥çœ‹æ›´æ–°æ—¥å¿—</small>
                    </div>
                </div>
            </div>

            <!-- ç»‘å®šå’Œè®¾ç½® -->
            <div class="command-category mb-4">
                <h6 class="category-title">
                    <i class="bi bi-link-45deg text-primary"></i> ç»‘å®šå’Œè®¾ç½®
                </h6>
                <div class="command-list">
                    <div class="command-item" onclick="insertCommand('/bind ')">
                        <code>/bind &lt;æºèŠå¤©&gt; [ç›®æ ‡èŠå¤©]</code> <span class="badge bg-secondary">ç®€å†™: /b</span>
                        <small class="text-muted">ç»‘å®šæºèŠå¤©å’Œç›®æ ‡èŠå¤©</small>
                    </div>
                    <div class="command-item" onclick="insertCommand('/settings')">
                        <code>/settings [è§„åˆ™ID]</code> <span class="badge bg-secondary">ç®€å†™: /s</span>
                        <small class="text-muted">ç®¡ç†è½¬å‘è§„åˆ™</small>
                    </div>
                    <div class="command-item" onclick="insertCommand('/switch')">
                        <code>/switch</code>
                        <small class="text-muted">åˆ‡æ¢å½“å‰ç®¡ç†çš„è§„åˆ™</small>
                    </div>
                </div>
            </div>

            <!-- å…³é”®å­—ç®¡ç† -->
            <div class="command-category mb-4">
                <h6 class="category-title">
                    <i class="bi bi-key text-warning"></i> å…³é”®å­—ç®¡ç†
                </h6>
                <div class="command-list">
                    <div class="command-item" onclick="insertCommand('/add ')">
                        <code>/add &lt;å…³é”®å­—&gt;</code> <span class="badge bg-secondary">ç®€å†™: /a</span>
                        <small class="text-muted">æ·»åŠ æ™®é€šå…³é”®å­—</small>
                    </div>
                    <div class="command-item" onclick="insertCommand('/add_regex ')">
                        <code>/add_regex &lt;æ­£åˆ™&gt;</code> <span class="badge bg-secondary">ç®€å†™: /ar</span>
                        <small class="text-muted">æ·»åŠ æ­£åˆ™è¡¨è¾¾å¼</small>
                    </div>
                    <div class="command-item" onclick="insertCommand('/list_keyword')">
                        <code>/list_keyword</code> <span class="badge bg-secondary">ç®€å†™: /lk</span>
                        <small class="text-muted">åˆ—å‡ºæ‰€æœ‰å…³é”®å­—</small>
                    </div>
                    <div class="command-item" onclick="insertCommand('/remove_keyword ')">
                        <code>/remove_keyword &lt;å…³é”®å­—&gt;</code> <span class="badge bg-secondary">ç®€å†™: /rk</span>
                        <small class="text-muted">åˆ é™¤å…³é”®å­—</small>
                    </div>
                </div>
            </div>

            <!-- æ›¿æ¢è§„åˆ™ç®¡ç† -->
            <div class="command-category mb-4">
                <h6 class="category-title">
                    <i class="bi bi-arrow-left-right text-success"></i> æ›¿æ¢è§„åˆ™
                </h6>
                <div class="command-list">
                    <div class="command-item" onclick="insertCommand('/replace ')">
                        <code>/replace &lt;æ­£åˆ™&gt; [æ›¿æ¢å†…å®¹]</code> <span class="badge bg-secondary">ç®€å†™: /r</span>
                        <small class="text-muted">æ·»åŠ æ›¿æ¢è§„åˆ™</small>
                    </div>
                    <div class="command-item" onclick="insertCommand('/list_replace')">
                        <code>/list_replace</code> <span class="badge bg-secondary">ç®€å†™: /lrp</span>
                        <small class="text-muted">åˆ—å‡ºæ‰€æœ‰æ›¿æ¢è§„åˆ™</small>
                    </div>
                    <div class="command-item" onclick="insertCommand('/remove_replace ')">
                        <code>/remove_replace &lt;åºå·&gt;</code> <span class="badge bg-secondary">ç®€å†™: /rr</span>
                        <small class="text-muted">åˆ é™¤æ›¿æ¢è§„åˆ™</small>
                    </div>
                </div>
            </div>

            <!-- é«˜çº§ç­›é€‰ -->
            <div class="command-category mb-4">
                <h6 class="category-title">
                    <i class="bi bi-funnel text-danger"></i> é«˜çº§ç­›é€‰
                </h6>
                <div class="command-list">
                    <div class="command-item" onclick="insertCommand('/set_duration ')">
                        <code>/set_duration &lt;æœ€å°ç§’&gt; [æœ€å¤§ç§’]</code>
                        <small class="text-muted">è®¾ç½®æ—¶é•¿èŒƒå›´</small>
                    </div>
                    <div class="command-item" onclick="insertCommand('/set_resolution ')">
                        <code>/set_resolution &lt;å®½&gt; &lt;é«˜&gt;</code>
                        <small class="text-muted">è®¾ç½®åˆ†è¾¨ç‡</small>
                    </div>
                    <div class="command-item" onclick="insertCommand('/set_size ')">
                        <code>/set_size &lt;æœ€å°&gt; [æœ€å¤§]</code>
                        <small class="text-muted">è®¾ç½®æ–‡ä»¶å¤§å° (æ”¯æŒK/M/G)</small>
                    </div>
                </div>
            </div>

            <!-- å»é‡ç®¡ç† -->
            <div class="command-category mb-4">
                <h6 class="category-title">
                    <i class="bi bi-filter-circle text-purple"></i> å»é‡ç®¡ç†
                </h6>
                <div class="command-list">
                    <div class="command-item" onclick="insertCommand('/dedup')">
                        <code>/dedup</code>
                        <small class="text-muted">åˆ‡æ¢å»é‡å¼€å…³</small>
                    </div>
                    <div class="command-item" onclick="insertCommand('/dedup_scan')">
                        <code>/dedup_scan</code>
                        <small class="text-muted">æ‰«æé‡å¤æ¶ˆæ¯</small>
                    </div>
                </div>
            </div>

            <!-- æ•°æ®åº“ç®¡ç† -->
            <div class="command-category mb-4">
                <h6 class="category-title">
                    <i class="bi bi-database text-info"></i> æ•°æ®åº“ç®¡ç†
                </h6>
                <div class="command-list">
                    <div class="command-item" onclick="insertCommand('/db_info')">
                        <code>/db_info</code>
                        <small class="text-muted">æŸ¥çœ‹æ•°æ®åº“ä¿¡æ¯</small>
                    </div>
                    <div class="command-item" onclick="insertCommand('/db_backup')">
                        <code>/db_backup</code>
                        <small class="text-muted">å¤‡ä»½æ•°æ®åº“</small>
                    </div>
                    <div class="command-item" onclick="insertCommand('/db_optimize')">
                        <code>/db_optimize</code>
                        <small class="text-muted">ä¼˜åŒ–æ•°æ®åº“</small>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
/* å‘½ä»¤é¢æ¿æ ·å¼ */
.command-panel-wrapper {
    background: var(--glass-bg);
    backdrop-filter: blur(20px);
    border: var(--glass-border);
    border-radius: var(--card-radius);
    overflow: hidden;
    box-shadow: var(--glass-shadow);
    transition: all 0.3s ease;
}

.command-panel-header {
    background: rgba(0, 0, 0, 0.03);
    padding: 1rem;
    border-bottom: 1px solid rgba(0, 0, 0, 0.05);
}

[data-theme="dark"] .command-panel-header {
    background: rgba(255, 255, 255, 0.02);
    border-bottom: 1px solid rgba(255, 255, 255, 0.05);
}

/* å‘½ä»¤è¾“å‡ºåŒºåŸŸ (ç»ˆç«¯æ ·å¼) */
.command-output {
    background: #1e1e1e;
    color: #d4d4d4;
    font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
    padding: 1rem;
    height: 400px;
    overflow-y: auto;
    font-size: 0.9rem;
    line-height: 1.6;
}

.command-output::-webkit-scrollbar {
    width: 8px;
}

.command-output::-webkit-scrollbar-track {
    background: #2d2d2d;
}

.command-output::-webkit-scrollbar-thumb {
    background: #555;
    border-radius: 4px;
}

.welcome-message {
    color: #4ec9b0;
    font-family: monospace;
    white-space: pre-line;
    animation: fadeIn 0.5s ease-out;
}

.command-line {
    margin-bottom: 0.5rem;
    animation: slideIn 0.3s ease-out;
}

.command-prompt {
    color: #4ec9b0;
    margin-right: 0.5rem;
}

.command-text {
    color: #569cd6;
}

.command-result {
    color: #d4d4d4;
    margin-left: 1rem;
    padding-left: 1rem;
    border-left: 2px solid #4ec9b0;
}

.command-error {
    color: #f48771;
}

.command-success {
    color: #4ec9b0;
}

.command-warning {
    color: #dcdcaa;
}

/* å‘½ä»¤è¾“å…¥åŒºåŸŸ */
.command-input-wrapper {
    padding: 1rem;
    border-top: 1px solid rgba(0, 0, 0, 0.05);
    position: relative;
}

[data-theme="dark"] .command-input-wrapper {
    border-top-color: rgba(255, 255, 255, 0.05);
}

.command-input {
    background: rgba(0, 0, 0, 0.02);
    border: 1px solid rgba(0, 0, 0, 0.1);
    font-family: 'Consolas', 'Monaco', monospace;
    font-size: 0.9rem;
}

[data-theme="dark"] .command-input {
    background: rgba(255, 255, 255, 0.02);
    border-color: rgba(255, 255, 255, 0.1);
    color: #d4d4d4;
}

.command-input:focus {
    background: rgba(0, 0, 0, 0.05);
    border-color: #4ec9b0;
    box-shadow: 0 0 0 3px rgba(78, 201, 176, 0.1);
}

/* è‡ªåŠ¨è¡¥å…¨å»ºè®® */
.autocomplete-suggestions {
    position: absolute;
    bottom: 100%;
    left: 1rem;
    right: 1rem;
    background: #2d2d2d;
    border: 1px solid #4ec9b0;
    border-radius: 8px;
    max-height: 200px;
    overflow-y: auto;
    display: none;
    z-index: 1000;
}

.autocomplete-suggestions.show {
    display: block;
}

.suggestion-item {
    padding: 0.5rem 1rem;
    color: #d4d4d4;
    cursor: pointer;
    transition: background 0.2s;
}

.suggestion-item:hover,
.suggestion-item.active {
    background: #3e3e3e;
    color: #4ec9b0;
}

.suggestion-item code {
    color: #569cd6;
}

/* å¿«æ·å‘½ä»¤ */
.quick-commands {
    padding: 1rem;
    background: rgba(0, 0, 0, 0.02);
    border-top: 1px solid rgba(0, 0, 0, 0.05);
}

[data-theme="dark"] .quick-commands {
    background: rgba(255, 255, 255, 0.02);
    border-top-color: rgba(255, 255, 255, 0.05);
}

/* å‘½ä»¤å†å² */
.command-history {
    padding: 1rem;
    background: rgba(0, 0, 0, 0.02);
    border-top: 1px solid rgba(0, 0, 0, 0.05);
}

.history-list {
    max-height: 200px;
    overflow-y: auto;
}

.history-item {
    padding: 0.5rem;
    background: rgba(0, 0, 0, 0.03);
    border-radius: 6px;
    margin-bottom: 0.5rem;
    cursor: pointer;
    transition: all 0.2s;
}

.history-item:hover {
    background: rgba(78, 201, 176, 0.1);
    transform: translateX(4px);
}

.history-item code {
    color: #569cd6;
}

/* å‘½ä»¤åˆ—è¡¨ä¾§è¾¹æ  */
.command-list-sidebar .command-category {
    border-bottom: 1px solid rgba(0, 0, 0, 0.05);
    padding-bottom: 1rem;
}

.category-title {
    color: var(--text-main);
    font-weight: 600;
    margin-bottom: 0.75rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.command-item {
    padding: 0.75rem;
    background: rgba(0, 0, 0, 0.02);
    border-radius: 8px;
    margin-bottom: 0.5rem;
    cursor: pointer;
    transition: all 0.2s;
    border-left: 3px solid transparent;
}

.command-item:hover {
    background: rgba(99, 102, 241, 0.1);
    border-left-color: var(--primary-color);
    transform: translateX(4px);
}

.command-item code {
    display: block;
    color: #569cd6;
    font-weight: 600;
    margin-bottom: 0.25rem;
}

.command-item small {
    display: block;
    color: var(--text-muted);
}

/* åŠ¨ç”» */
@keyframes fadeIn {
    from {
        opacity: 0;
    }
    to {
        opacity: 1;
    }
}

@keyframes slideIn {
    from {
        opacity: 0;
        transform: translateY(-10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* å“åº”å¼ */
@media (max-width: 768px) {
    .command-output {
        height: 300px;
        font-size: 0.8rem;
    }
    
    .quick-commands .btn {
        font-size: 0.75rem;
        padding: 0.375rem 0.75rem;
    }
}
</style>
